#!/bin/sh

SESSION_NAME="extreme"

cd ~/Documents/nyu/junior-year/fall/extreme-design/code/automation

tmux has-session -t ${SESSION_NAME}

if [ $? != 0 ]
then
  # Create the session
  tmux new-session -s ${SESSION_NAME} -n vim -d

  # First window (0) -- vim and console
  tmux send-keys -t ${SESSION_NAME} 'vim .' C-m

  # shell (1)
  tmux new-window -n bash -t ${SESSION_NAME}
  tmux send-keys -t ${SESSION_NAME}:1 'git s' C-m

  # mongo (2)
  tmux new-window -n mongo -t ${SESSION_NAME}
  tmux send-keys -t ${SESSION_NAME}:2 'mongod' C-m

  # server/debug log (3)
  tmux new-window -n server -t ${SESSION_NAME}
  tmux send-keys -t ${SESSION_NAME}:3 'python bin/main.py' C-m
  tmux split-window -v -t ${SESSION_NAME}:3
  tmux send-keys -t ${SESSION_NAME}:3.1 'tail -f automation.log' C-m

  # Start out on the first window when we attach
  tmux select-window -t ${SESSION_NAME}:0
fi
tmux attach -t ${SESSION_NAME}
